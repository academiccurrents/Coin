<div class="coin-page coin-pay-page">
  <div class="coin-container">
    {{!-- é¡¶éƒ¨å¯¼èˆªæ  --}}
    <div class="coin-nav">
      <div class="coin-nav-left">
        <button class="coin-nav-back" {{on "click" this.goBack}}>
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
        </button>
        <span class="coin-nav-icon">ğŸ’°</span>
        <span class="coin-nav-title">å……å€¼ä¸­å¿ƒ</span>
      </div>
    </div>

    {{!-- å½“å‰ä½™é¢å’ŒæŠ˜æ‰£ä¿¡æ¯ --}}
    <div class="pay-balance-card">
      <div class="pay-balance-info">
        <span class="pay-balance-label">å½“å‰ä½™é¢</span>
        <span class="pay-balance-amount">{{model.balance}} {{model.coinName}}</span>
      </div>
      {{#if model.hasDiscount}}
        <div class="pay-discount-badge">
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M374.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-320 320c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l320-320zM128 128A64 64 0 1 0 0 128a64 64 0 1 0 128 0zM384 384a64 64 0 1 0 -128 0 64 64 0 1 0 128 0z"/></svg>
          <span>{{model.discountRate}}% æŠ˜æ‰£</span>
        </div>
      {{/if}}
    </div>

    {{!-- å¥—é¤é€‰æ‹© --}}
    <div class="coin-section">
      <div class="section-header">
        <h2 class="section-title">
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M512 80c0 18-14.3 34.6-38.4 48c-29.1 16.1-72.5 27.5-122.3 30.9c-3.7-1.8-7.4-3.5-11.3-5C300.6 137.4 248.2 128 192 128c-8.3 0-16.4 .2-24.5 .6l-1.1-.6C142.3 114.6 128 98 128 80c0-44.2 86-80 192-80S512 35.8 512 80zM160.7 161.1c10.2-.7 20.7-1.1 31.3-1.1c62.2 0 117.4 12.3 152.5 31.4C369.3 204.9 384 221.7 384 240c0 4-.7 7.9-2.1 11.7c-4.6 13.2-17 25.3-35 35.5c0 0 0 0 0 0c-.1 .1-.3 .1-.4 .2l0 0 0 0c-.3 .2-.6 .3-.9 .5c-35 19.4-90.8 32-153.6 32c-59.6 0-112.9-11.3-148.2-29.1c-1.9-.9-3.7-1.9-5.5-2.9C14.3 274.6 0 258 0 240c0-34.8 53.4-64.5 128-75.4c10.5-1.5 21.4-2.7 32.7-3.5zM416 240c0-21.9-10.6-39.9-24.1-53.4c28.3-4.4 54.2-11.4 76.2-20.5c16.3-6.8 31.5-15.2 43.9-25.5V176c0 19.3-16.5 37.1-43.8 50.9c-14.6 7.4-32.4 13.7-52.4 18.5c.1-1.8 .2-3.5 .2-5.3zm-32 96c0 18-14.3 34.6-38.4 48c-1.8 1-3.6 1.9-5.5 2.9C304.9 404.7 251.6 416 192 416c-62.8 0-118.6-12.6-153.6-32C14.3 370.6 0 354 0 336V300.6c12.5 10.3 27.6 18.7 43.9 25.5C83.4 342.6 135.8 352 192 352s108.6-9.4 148.1-25.9c7.8-3.2 15.3-6.9 22.4-10.9c6.1-3.4 11.8-7.2 17.2-11.2c1.5-1.1 2.9-2.3 4.3-3.4V336zm32 0V269.5c28.3-4.4 54.2-11.4 76.2-20.5c16.3-6.8 31.5-15.2 43.9-25.5V272c0 44.2-86 80-192 80c-11.1 0-22-1-32.6-2.9c15.2-5.4 29.1-12.1 41.1-19.8c35.7-22.6 63.5-56.1 63.5-97.3z"/></svg>
          <span>é€‰æ‹©å……å€¼å¥—é¤</span>
        </h2>
      </div>
      <div class="package-grid">
        {{#each model.packages as |package|}}
          <div class="package-card {{if (eq this.selectedPackageId package.id) 'selected'}} {{if package.recommended 'recommended'}}" {{on "click" (fn this.selectPackage package)}}>
            {{#if package.recommended}}
              <span class="package-badge">æ¨è</span>
            {{/if}}
            <div class="package-coins">
              <span class="package-coins-num">{{package.coin_amount}}</span>
              <span class="package-coins-unit">{{model.coinName}}</span>
            </div>
            <div class="package-price">
              {{#if model.hasDiscount}}
                <span class="package-original-price">Â¥{{package.original_price}}</span>
              {{/if}}
              <span class="package-actual-price">Â¥{{package.actual_price}}</span>
            </div>
          </div>
        {{else}}
          <div class="empty-state">
            <span>æš‚æ— å¯ç”¨å¥—é¤</span>
          </div>
        {{/each}}
      </div>
    </div>

    {{!-- æ”¯ä»˜æ–¹å¼é€‰æ‹© --}}
    <div class="coin-section">
      <div class="section-header">
        <h2 class="section-title">
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96v32H576V96c0-35.3-28.7-64-64-64H64zM576 224H0V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V224zM112 352h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16zm112 16c0-8.8 7.2-16 16-16H368c8.8 0 16 7.2 16 16s-7.2 16-16 16H240c-8.8 0-16-7.2-16-16z"/></svg>
          <span>é€‰æ‹©æ”¯ä»˜æ–¹å¼</span>
        </h2>
      </div>
      <div class="payment-methods">
        {{#each model.channels as |channel|}}
          <div class="payment-method {{if (eq this.selectedPaymentType channel.type) 'selected'}}" {{on "click" (fn this.selectPaymentType channel.type)}}>
            <div class="payment-method-icon {{channel.type}}">
              {{#if (eq channel.type "alipay")}}
                <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M377.74 32H70.26C31.41 32 0 63.41 0 102.26v307.48C0 448.59 31.41 480 70.26 480h307.48c38.52 0 69.76-31.08 70.26-69.6-45.96-25.62-110.59-60.34-171.6-88.44-32.07 43.97-84.14 81-148.62 81-70.59 0-93.73-45.3-97.04-76.37-3.97-39.01 14.88-81.5 99.52-81.5 35.38 0 79.35 10.25 127.13 24.96 16.53-30.09 26.45-60.34 26.45-60.34h-178.2v-16.7h92.08v-31.24H88.28v-19.01h109.44V92.34h50.92v50.42h109.44v19.01H248.63v31.24h88.77s-15.21 46.62-38.35 90.92c48.93 16.7 100.01 36.04 148.62 52.74V102.26C447.83 63.57 416.43 32 377.74 32zM47.28 322.95c.99 20.17 10.25 53.73 69.93 53.73 52.07 0 92.58-39.68 117.87-72.9-44.63-18.68-84.48-31.41-109.44-31.41-67.45 0-79.35 33.06-78.36 50.58z"/></svg>
              {{else if (eq channel.type "wxpay")}}
                <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M385.2 167.6c25.9 0 51.3 5.2 74.9 15.2c-6.9-66.8-74.2-118.4-152.7-118.4c-86.1 0-156 59.5-156 132.8c0 42.3 23.4 79.5 60.1 104.3l-15.5 46.5l54.3-27.1c18.3 4.6 37.4 7 57.1 7c8.3 0 16.5-.5 24.5-1.4c-5.1-16.4-7.9-33.8-7.9-51.8c0-59.2 52.8-107.1 117.2-107.1zM128.5 168.1c-13.3 0-24.1-10.8-24.1-24.1s10.8-24.1 24.1-24.1s24.1 10.8 24.1 24.1s-10.8 24.1-24.1 24.1zm128.5 0c-13.3 0-24.1-10.8-24.1-24.1s10.8-24.1 24.1-24.1s24.1 10.8 24.1 24.1s-10.8 24.1-24.1 24.1zM576 274.7c0-59.5-59.5-107.8-132.8-107.8s-132.8 48.3-132.8 107.8s59.5 107.8 132.8 107.8c15.5 0 30.4-2.1 44.3-5.9l42.3 21.1l-12.1-36.2c29.7-20.1 48.3-50.1 48.3-86.8zm-176.5-32.1c-10.8 0-19.5-8.7-19.5-19.5s8.7-19.5 19.5-19.5s19.5 8.7 19.5 19.5s-8.7 19.5-19.5 19.5zm87.5 0c-10.8 0-19.5-8.7-19.5-19.5s8.7-19.5 19.5-19.5s19.5 8.7 19.5 19.5s-8.7 19.5-19.5 19.5z"/></svg>
              {{else if (eq channel.type "qqpay")}}
                <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z"/></svg>
              {{else}}
                <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96v32H576V96c0-35.3-28.7-64-64-64H64zM576 224H0V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V224z"/></svg>
              {{/if}}
            </div>
            <span class="payment-method-name">{{channel.name}}</span>
            {{#if (eq this.selectedPaymentType channel.type)}}
              <div class="payment-method-check">
                <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"/></svg>
              </div>
            {{/if}}
          </div>
        {{/each}}
      </div>
    </div>

    {{!-- æ”¯ä»˜æŒ‰é’®åŒºåŸŸ --}}
    <div class="pay-footer">
      <div class="pay-summary">
        <span class="pay-label">åº”ä»˜é‡‘é¢</span>
        <span class="pay-amount">Â¥{{this.totalAmount}}</span>
      </div>
      <button class="pay-btn" {{on "click" this.submitPayment}} disabled={{this.payDisabled}}>
        {{#if this.isLoading}}
          <span>å¤„ç†ä¸­...</span>
        {{else}}
          <span>ç«‹å³æ”¯ä»˜</span>
        {{/if}}
      </button>
    </div>
  </div>

  {{!-- äºŒç»´ç æ”¯ä»˜æ¨¡æ€æ¡† --}}
  {{#if this.showQrcodeModal}}
    <div class="coin-modal-overlay" {{on "click" this.closeQrcodeModal}}>
      <div class="coin-modal qrcode-modal" {{on "click" this.stopPropagation}}>
        <div class="modal-header">
          <div class="modal-title-wrap">
            <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 80C0 53.5 21.5 32 48 32h96c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80zM64 96v64h64V96H64zM0 336c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V336zm64 16v64h64V352H64zM304 32h96c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48H304c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48zm16 64v64h64V96H320zM256 304c0-8.8 7.2-16 16-16h64c8.8 0 16 7.2 16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s7.2-16 16-16s16 7.2 16 16v96c0 8.8-7.2 16-16 16H368c-8.8 0-16-7.2-16-16s-7.2-16-16-16s-16 7.2-16 16v64c0 8.8-7.2 16-16 16H272c-8.8 0-16-7.2-16-16V304z"/></svg>
            <h3>æ‰«ç æ”¯ä»˜</h3>
          </div>
          <button class="modal-close-btn" {{on "click" this.closeQrcodeModal}}>
            <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/></svg>
          </button>
        </div>
        <div class="modal-body qrcode-body">
          <img src="{{this.qrcodeUrl}}" alt="æ”¯ä»˜äºŒç»´ç " class="qrcode-image" />
          <p class="qrcode-hint">è¯·ä½¿ç”¨{{this.paymentTypeName}}æ‰«ç æ”¯ä»˜</p>
          <p class="qrcode-amount">Â¥{{this.totalAmount}}</p>
          <p class="qrcode-status">æ”¯ä»˜å®Œæˆåå°†è‡ªåŠ¨è·³è½¬...</p>
        </div>
      </div>
    </div>
  {{/if}}
</div>
